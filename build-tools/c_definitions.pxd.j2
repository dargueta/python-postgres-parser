# Autogenerated file -- DO NOT EDIT
# Source(s): {{ headers|map(attribute="full_fname")|join(", ") }}

# Copyright 2021 Diego Argueta
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#     http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.

# distutils: include_dirs=extern/libpg_query
# cython: language_level=3

from libc cimport stdint

{% macro typeof(name) %}
    {%- if name == "bool" %}bint
    {%- elif name.endswith("_t") %}stdint.{{ name }}
    {%- else %}{{ name }}
    {%- endif %}
{%- endmacro -%}

{% for header in headers %}
cdef extern from "{{ header.include_path }}" nogil:
    # Structs
    {% for struct in header.all_classes %}
    {{ "ctypedef" if struct.bare_name.startswith("<anon") else "cdef" }} struct {{ struct.name }}:
        {% for prop in struct.properties.public %}
        {{ typeof(prop.type) }} {{ prop.name }}
        {% endfor %}

    {% endfor %}

    # Functions
    {% for func in header.functions %}
    {{ typeof(func.returns) }} {{ func.name }}(
        {% for param in func.parameters %}
        {{ typeof(param.type) }} {{ param.name }} {{- "," if not loop.last }}
        {% endfor %}
    )

    {% endfor %}
{% endfor %}
